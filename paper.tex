\documentclass{article}


\usepackage[superscript,biblabel]{cite}
% \usepackage[super,numbers]{natbib}
\bibliographystyle{naturemag}
% \bibliographystyle{plain}
\usepackage[hidelinks]{hyperref}
\usepackage{authblk}
\usepackage{tabularray}

% Make affiliations run inline
\renewcommand\Affilfont{\small}
\renewcommand\Authfont{\normalsize}

% Key change: make affiliations run inline
\makeatletter
\renewcommand\AB@affilsepx{;\hspace{0.6em}\protect\Affilfont}
\makeatother

\begin{document}

\title{Population-scale Ancestral Recombination Graphs with tskit 1.0}

\input{authors.tex}

\date{}
\maketitle

% ARGs are now practical, and tskit is the infrastructure enabling their use.

\noindent
Ancestral recombination graphs (ARGs) capture the full genetic history of
samples from a recombining species.
Although ARGs have been a central
theoretical object in population genetics for decades, their practical use was
constrained by the lack of scalable inference methods, standard
interchange formats, and software infrastructure. Recent breakthroughs in
simulation and inference have substantially changed this landscape,
leading to renewed interest in ARG-based analyses across population and statistical
genetics\cite{brandt2024promise,lewanski2024era,nielsen2024inference}.
% genetics\cite{lewanski2024era}.
The tskit library has played a key enabling role in this shift
and has become foundational infrastructure for working with ARGs.
This paper marks the release of tskit 1.0, which formalises long-term stability
guarantees for its data formats and APIs.

% The succinct tree sequence is a complete, lossless encoding of ARGs.
At the core of tskit is the succinct tree sequence data model which
defines a set of nodes (genomes at particular times) and
edges (parent-child inheritance relationships spanning genomic intervals)
in a simple tabular form\cite{kelleher2018efficient}.
This encoding provides a lossless representation of a general class of
ARGs, establishing a precise and machine-readable
definition suitable for large-scale computation\cite{wong2024general}.
The data model also incorporates site, mutation, population, and pedigree
information and supports arbitrary
metadata associated with different components of the ARG.
Provenance information is recorded natively, enhancing reproducibility
and transparency.
Together, these features make the tskit data model a
semantically complete and interoperable
representation of ARGs that serves as a common foundation across diverse
analytical workflows.

% This encoding first proved itself by transforming population-genetic
% simulation.

Simulation is a fundamental tool in population genomics, and
was the first domain in which the tskit data model demonstrated its impact.
Introduced initially as part of the msprime simulator,
the tskit data model enabled performance improvements of
several orders of magnitude
over previous coalescent simulation approaches\cite{kelleher2016efficient}.
The same representation later
enabled efficient forward-time simulation of ARGs
and yielded substantial speedups by avoiding
explicit simulation of neutral mutations\cite{kelleher2018efficient}.
Because these forward-time and coalescent
simulators share a common underlying representation, their complementary
strengths can be combined within a single workflow. This has made it possible
to simulate ARGs under complex demographic scenarios involving geography and
selection that were previously infeasible, providing essential ground truth for
method evaluation. Simulation capabilities have continued to expand,
including whole-autosome ARG simulations for nearly 1.5 million individuals
based on a large human pedigree\cite{andersontrocme2023genes}.
A growing ecosystem of forward-time, coalescent, and hybrid simulation tools
builds directly on tskit (Table S1).

% Inference methods interoperate through tskit, enabling evaluation and reuse
% without imposing design choices.

The lack of scalable inference methods has been a major obstacle
to practical application of ARG inference methods. Although there
are many inference methods (see Wong et al.\cite{wong2024general}\ for a review),
tsinfer was the first to scale to hundreds of thousands of samples,
directly leveraging the tskit data model\cite{kelleher2019inferring}.
Many recent ARG inference methods have chosen to support tskit
as an output format in addition to their
own native representations (Table S1).
This shared output layer enables inferred ARGs to
interoperate directly with simulators, facilitating systematic evaluation and
benchmarking against known ground truth. It also shifts the burden of format
conversion away from downstream users, who can instead rely on inference tools
to emit results in a common, well-defined representation. The scalability and
flexibility of this approach are illustrated by the recent inference of an ARG
for 2.48 million SARS-CoV-2 whole genomes, which occupies 32 MiB of storage and
can be loaded into memory in under a second\cite{zhan2025pandemic}.

% Shared representation unlocks fast, correct, and reusable downstream
% analysis.

Efficient storage and analysis of large genetic datasets is a central
design goal of tskit, and the data model has enabled substantial
performance gains in downstream analyses.
For example, single-site
population genetic statistics can be computed orders of magnitude faster than from
genotype matrices while using far less memory by operating
on the underlying ARG structure\cite{ralph2020efficiently}.
Tskit exposes a large API with a
performance-critical core implemented in C and bindings available for Python,
Rust, and R. Its vectorised, table-first design allows zero-copy access to
underlying arrays, supporting high-performance analysis pipelines.
As a result,
downstream tools inherit performance and correctness properties from a shared,
well-tested core.

% tskit 1.0 formalises this ecosystem as stable, long-term scientific
% infrastructure.

The goal of tskit is to provide a shared technical foundation, centred on
efficient, well-tested, and thoroughly documented primitive operations on ARGs, rather
than to directly implement end-user workflows.
This design principle has enabled a broad ecosystem of downstream
software---spanning simulation, ARG inference, population and statistical genetic
inference, analysis, and visualisation---with 62 published tools now using tskit
as a core dependency (Table S1).
With the release of tskit 1.0, long-term stability of the data model
and APIs is explicitly guaranteed, reflecting a commitment to maintain this
minimal and composable core as the project evolves. By focusing on stable
primitives rather than prescribing analytical pipelines, tskit enables
methodological innovation to concentrate on modelling, inference, and
interpretation rather than bespoke data formats and tooling. In this way, tskit
1.0 provides a common and extensible foundation that supports the continued
expansion of ARG-based analyses as datasets, methods, and applications continue
to grow.
Extensive documentation, tutorials, and other information are available
at \url{https://tskit.dev}.


% There is a hard limit of 10 references for this type of article!
% Citations (sorted alphabetically here for ease of editing):

% 1 - andersontrocme2023genes
% X - brandt2024promise The Promise of Inferring the Past Using the Ancestral Recombination Graph
% 2 - haller2025simHumanity
% 3 - lewanski2024era The era of the ARG: An introduction to ancestral recombination graphs and their significance in empirical evolutionary genomics
% X - nielsen2024inference Inference and applications of ancestral recombination graphs
% 4 - kelleher2016efficient
% 5 - kelleher2018efficient
% 6 - kelleher2019inferring
% 7 - ralph2020efficiently
% 8 - wohns2022unified or pope2026tracing TODO: pick one of these two
% 9 - wong2024general
% 10 - zhan2025pandemic

\section*{Acknowledgments}

\bibliography{paper}

\newpage

\section*{Supplementary Information}
\appendix
\setcounter{table}{0}
\setcounter{figure}{0}
\renewcommand{\thetable}{S\arabic{table}}
\renewcommand{\thefigure}{S\arabic{figure}}
\renewcommand{\thesubsection}{\arabic{subsection}}

This section contains the supplementary information, which we integrate
into the main document for ease of review.

\subsection*{Published tools using tskit}
We performed a search for published software using tskit.
To be included in this list, the software must be described in a publication
as a named tool intended for reuse and must use tskit.
This list is intentionally conservative, and does not include
(for example) publications depending on bespoke analysis
pipelines using tskit.
For each tool Table S1, we list: its name (with a clickable
hyperlink to its source code repository);
the main implementation
language(s) of the tool based on GitHub summaries;
the DOI (with clickable hyperlink) of the publication in which this
tool was first described (or, in the case of SLiM, the first
publication in which tskit-based features were described);
and the year of publication and number of citations to this
publication according to data from OpenAlex
(\url{https://openalex.org}) retrieved on 2026-01-23.

\input{tools_table.tex}


\end{document}
