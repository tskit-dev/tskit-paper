\documentclass{article}


\usepackage[superscript,biblabel]{cite}
% \usepackage[super,numbers]{natbib}
\bibliographystyle{naturemag}
% \bibliographystyle{plain}

\usepackage{booktabs}%


\begin{document}

\title{Population scale Ancestral Recombination Graphs with tskit 1.0}
\author{Author list to be filled in}
\maketitle



% ARGs are now practical, and tskit is the infrastructure enabling their use.

Ancestral recombination graphs (ARGs) capture the full genealogical history of
samples from a recombining species~\cite{wong2024general}. 
Although ARGs have been a central
theoretical object in population genetics for decades, their practical use was
long constrained by the lack of scalable inference methods, standard
interchange formats, and robust software infrastructure. Recent advances in
simulation and inference have substantially changed this landscape, leading to
renewed interest in ARG-based analyses across population and statistical
genetics~\cite{brandt2024promise,lewanski2024era,nielsen2024inference}.
Within this shift, the tskit library has played a key enabling role
and has become foundational infrastructure for working with ARGs at scale. This
paper marks the release of tskit 1.0, which formalises long-term stability
guarantees for its data model and APIs.


% The succinct tree sequence is a complete, lossless encoding of ARGs.
At the core of tskit is the succinct tree sequence data model, which records a
set of nodes (ancestral genomes at particular times) and edges (parent–child
inheritance relationships spanning genomic intervals) in a simple tabular form.
This encoding provides a lossless representation of a general class of
ancestral recombination graphs, establishing a precise and machine-readable
definition of ARGs suitable for large-scale computation. By exploiting the fact
that neighbouring genomic regions typically differ only by small changes in
local tree structure, the model enables a class of efficient algorithms that
operate directly on genealogical variation along the genome. The data model
also incorporates population and pedigree information and supports arbitrary
metadata associated with different components of the ARG. Provenance
information is recorded natively, enhancing reproducibility and auditability.
Together, these features make tskit a semantically complete and interoperable
representation of ARGs that can serve as a common foundation across diverse
analytical workflows.

% This encoding first proved itself by transforming population-genetic
% simulation.

Simulation has been a primary driver of progress in population genomics, and it
was the first domain in which the tskit data model demonstrated its impact.
Introduced initially as part of the msprime simulator, the use of succinct tree
sequences enabled performance improvements of up to six orders of magnitude
over previous coalescent simulation approaches. The same representation later
enabled efficient forward-time simulation through pedigree recording with
periodic simplification, yielding speedups of up to fifty-fold by avoiding
explicit simulation of neutral mutations. Because forward-time and coalescent
simulators share a common underlying representation, their complementary
strengths can be combined within a single workflow. This has made it possible
to simulate ARGs under complex demographic scenarios involving geography and
selection that were previously infeasible, providing essential ground truth for
method evaluation. Simulation capabilities have continued to expand,
culminating in whole-genome ARG simulations for nearly 1.5 million individuals
based on large pedigrees. A growing ecosystem of simulation tools now builds
directly on tskit.


% Inference methods interoperate through tskit, enabling evaluation and reuse
% without imposing design choices.

A major remaining challenge for the application of ARG methods has been
scalable inference from large datasets. Building directly on the tskit data
model and its incremental algorithms, tsinfer was the first inference method to
scale to hundreds of thousands of samples. Since then, many ARG inference
methods have chosen to support tskit as an output format, in addition to their
own native representations. This shared output layer enables inferred ARGs to
interoperate directly with simulators, facilitating systematic evaluation and
benchmarking against known ground truth. It also shifts the burden of format
conversion away from downstream users, who can instead rely on inference tools
to emit results in a common, well-defined representation. The scalability and
flexibility of this approach are illustrated by the recent inference of an ARG
for 2.48 million SARS-CoV-2 whole genomes, which occupies 32 MiB on disk and
can be loaded into memory in under a second.


% Shared representation unlocks fast, correct, and reusable downstream
% analysis.

Efficient storage and analysis of large genealogical datasets is a central
design goal of tskit, and the tree-sequence representation enables substantial
performance gains in downstream analyses. For example, single-site statistics
such as Tajima’s D can be computed up to a thousand times faster than from
genotype matrices, while using far less memory, by operating directly on
genealogical branches rather than sampled genotypes. This branch-based
perspective provides a natural dual to traditional site-based analyses. Tskit
exposes a large API spanning statistical calculations and visualisation, with a
performance-critical core implemented in C and bindings available in Python,
Rust, and R. Its vectorised, table-first design allows zero-copy access to
underlying arrays, for example through NumPy, supporting high-performance
analysis pipelines that avoid unnecessary memory duplication. As a result,
downstream tools inherit performance and correctness properties from a shared,
well-tested core.

% tskit 1.0 formalises this ecosystem as stable, long-term scientific
% infrastructure.

Tskit is now established as foundational infrastructure for population-scale
genealogical analysis. Table 1 summarises 56 published software tools that rely
on tskit, spanning simulation, inference, statistical genetics, visualisation,
and data processing. The release of tskit 1.0 marks the maturity of this
ecosystem and introduces explicit guarantees of long-term stability for the
data model and APIs. These guarantees, together with a global community of
contributors, allow tskit to be adopted with confidence as a durable scientific
resource and a common interchange format. As the field continues to develop,
challenges such as incorporating structural variation will require extensions
to the data model, but these will be pursued in a way that preserves stability
and interoperability. In this context, tskit 1.0 represents a transition from a
successful software library to stable infrastructure supporting
population-scale analyses of ancestry and recombination.


\begin{table}
\caption{The tskit software ecosystem. * data not available on OpenAlex}
\begin{scriptsize}
\begin{center}
\begin{tabular}{lllrr}
\toprule
name & interface & package & year & citations \\
\midrule
\multicolumn{5}{c}{\textsc{Simulation}} \\
\midrule
pyslim & Python & pypi, conda & 2025 & 1 \\
TwisstNTern & Python &  & 2025 & 0 \\
tstrait & Python & pypi, conda & 2024 & 8 \\
slendr & Python & CRAN & 2023 & 15 \\
cnasim & Python & pypi & 2023 & 10 \\
gridCoal & Python &  & 2022 & 5 \\
Geonomics & Python & pypi & 2021 & 20 \\
stdpopsim & Python & pypi, conda & 2020 & 233 \\
RADinitio & Python & pypi & 2020 & 49 \\
fwdpy11 & C, Python & pypi, conda & 2019 & 74 \\
SLiM & C &  & 2018 & 860 \\
msprime & C, Python & pypi, conda & 2016 & 806 \\

\midrule
\multicolumn{5}{c}{\textsc{ARG Inference}} \\
\midrule
SINGER & Python &  & 2025 & 12 \\
sticcs & Python &  & 2025 & 0 \\
POLEGON & Python &  & 2025 & 0 \\
Threads & Python & pypi & 2024 & 22 \\
espalier & Python & pypi & 2023 & 14 \\
sc2ts & Python & pypi & 2023 & 14 \\
tsdate & Python & pypi, conda & 2022 & 187 \\
ARGinfer & Python & pypi & 2022 & 37 \\
Relate & C &  & 2019 & 562 \\
tsinfer & C, Python & pypi, conda & 2019 & 373 \\
ARGneedle & Python & pypi & * &  \\

\midrule
\multicolumn{5}{c}{\textsc{Population Genetic Inference}} \\
\midrule
gaia & C &  & 2025 & 8 \\
mrpast & Python & pypi & 2025 & 0 \\
phlash & Python & pypi & 2025 & 0 \\
sparg & Python & pypi & 2025 & 0 \\
spacetrees & Python &  & 2024 & 18 \\
mapNN & Python &  & 2024 & 4 \\
gIMble & Python & conda & 2023 & 33 \\
disperseNN2 & Python & pypi & 2023 & 10 \\
dinf & Python & pypi & 2023 & 8 \\
GADMA & Python & pypi & 2022 & 23 \\
dnadna & Python & pypi, conda & 2022 & 8 \\
DISMaL & Python & pypi & 2021 & 7 \\
ReLERNN & Python & pypi & 2020 & 166 \\
momi2 & Python & pypi & 2019 & 170 \\

\midrule
\multicolumn{5}{c}{\textsc{Statistical Genetic Inference}} \\
\midrule
as-eGRM & Python &  & 2025 & 1 \\
arg-lmm & Python & pypi & 2025 & 0 \\
tslmm & Python &  &  &  \\
lgdm & Python & pypi & 2023 & 38 \\
egrm & Python & pip & 2022 & 44 \\

\midrule
\multicolumn{5}{c}{\textsc{Visualisation}} \\
\midrule
tsbrowse & Python & pypi & 2025 & 0 \\
ARGscape & Python & pypi & 2025 & 0 \\
tskit-arg-visualizer & Python & pypi & 2024 & 0 \\

\midrule
\multicolumn{5}{c}{\textsc{Data processing}} \\
\midrule
bio2zarr & python & pypi, conda & 2025 & 0 \\

\midrule
\multicolumn{5}{c}{\textsc{Analysis}} \\
\midrule
tscompare & Python & pypi & 2025 & 1 \\
twisst2 & Python &  & 2025 & 0 \\
tspop & Python & pypi & 2023 & 12 \\
\bottomrule
\end{tabular}
\end{center}
\end{scriptsize}
\end{table}


% Citations:

% - wong2024general
% - brandt2024promise
% - lewanski2024era
% - nielsen2024inference
% - kelleher2016efficient
% - kelleher2016efficient
% - kelleher2019inferring
% - ralph2020efficiently
% - andersontrocme2023genes
% - zhan2025pandemic


\section*{Acknowledgments}

\bibliography{paper}


\end{document}
